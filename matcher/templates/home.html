{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CV-Matcher</title>
  <link rel="stylesheet" href="{% static 'css/style.css' %}?v=301">
</head>
<body>
  <div class="container">

    <!-- Hero section -->
    <section class="hero">
      <h1>Match your CV to any job in seconds.</h1>
      <p class="tagline">
        Upload your CV, paste the job description, and get a quick similarity score with keyword fixes.
      </p>
    </section>

    <!-- Upload Card -->
    <div class="card">
      <form method="post" enctype="multipart/form-data" class="row">
        {% csrf_token %}

        <label for="cv">Upload CV (.pdf / .docx / .txt)</label>
        <input type="file" id="cv" name="cv" accept=".pdf,.docx,.txt" required>

        <label for="jd">Job description</label>
        <textarea id="jd" name="jd" placeholder="Paste the job description here..." required></textarea>

        <button type="submit" class="btn">Analyze now</button>
      </form>

      {% if had_input %}
      <!-- Results -->
      <div class="result">
        <h2>Results</h2>
        <p><strong>Similarity score:</strong> {{ score }} / 100</p>
        <progress value="{{ score }}" max="100"></progress>

        {% if missing_keywords %}
          <p style="margin-top:10px"><strong>Missing keywords from job post:</strong></p>
          <p>{{ missing_keywords|join:", " }}</p>
        {% else %}
          <p style="margin-top:10px"><strong>Nice!</strong> Your CV already mentions the key terms in this posting.</p>
        {% endif %}

        <h3 style="margin-top:16px">Improved CV (draft)</h3>
        <textarea style="width:100%;min-height:220px">{{ improved_text }}</textarea>

        <p style="margin-top:12px">
          <a class="btn" href="{% url 'download_txt' %}">Download improved CV (.txt)</a>
        </p>
      </div>
      {% endif %}
    </div>

    <!-- Footer -->
    <footer>
      <p>No database. Files are processed in-memory only.</p>
    </footer>
  </div>
</body>
</html>
